<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>S&P 500 – Hourly Price Snapshot</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body { font-family: Arial; background:#f4f6f8; padding:20px; }
h1 { text-align:center; }
.timestamp { text-align:center; color:#555; margin-bottom:20px; }
table { width:100%; border-collapse:collapse; background:#fff; }
th, td { padding:10px; border-bottom:1px solid #ddd; text-align:center; }
th { background:#222; color:#fff; }
.error { color:red; text-align:center; }
</style>
</head>

<body>

<h1>S&P 500 – Hourly Price Snapshot</h1>
<div class="timestamp" id="lastUpdated">Loading...</div>

<table id="stocksTable"></table>
<div class="error" id="error"></div>

<script>
async function loadData() {
  try {
    const res = await fetch("data/stocks.json?ts=" + Date.now());
    const json = await res.json();

    document.getElementById("lastUpdated").innerText =
      "Last updated: " + new Date(json.last_updated).toLocaleString();

    const table = document.getElementById("stocksTable");
    table.innerHTML = `
      <tr>
        <th>Ticker</th>
        <th>Company</th>
        <th>Price ($)</th>
      </tr>
    `;

    json.stocks.forEach(s => {
      table.innerHTML += `
        <tr>
          <td>${s.symbol}</td>
          <td>${s.name}</td>
          <td>${s.price ?? "-"}</td>
        </tr>
      `;
    });

  } catch (e) {
    document.getElementById("error").innerText =
      "Failed to load local stock data.";
  }
}

loadData();
setInterval(loadData, 60 * 60 * 1000);
</script>

</body>
</html>
